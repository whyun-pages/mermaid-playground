<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mermaid ÊºîÁªÉÂú∫</title>
    <link rel="stylesheet" href="./src/styles/main.css">
</head>
<body>
    <div id="app">
        <!-- ÂØºËà™ËèúÂçï -->
        <nav class="navbar">
            <div class="nav-brand">
                <h1>Mermaid ÊºîÁªÉÂú∫</h1>
            </div>
            <div class="nav-user">
                <span class="name">Êú™ÂëΩÂêç</span>
            </div>
            <div class="nav-controls">
                <div class="template-selector">
                    <button id="template-toggle" class="btn btn-secondary">
                        <span class="icon">üìã</span>
                        Ê®°Êùø
                        <span class="dropdown-arrow">‚ñº</span>
                    </button>
                    <div id="template-dropdown" class="dropdown hidden">
                        <div class="dropdown-content">
                            <div class="template-item" data-template="flowchart">
                                <div class="template-name">ÊµÅÁ®ãÂõæ</div>
                                <div class="template-preview">
                                    <svg width="120" height="80" viewBox="0 0 120 80">
                                        <rect x="10" y="10" width="30" height="20" fill="#e1f5fe" stroke="#01579b" stroke-width="1"/>
                                        <text x="25" y="22" font-size="8" text-anchor="middle" fill="#01579b">ÂºÄÂßã</text>
                                        <path d="M 40 20 L 50 20" stroke="#01579b" stroke-width="1" marker-end="url(#arrowhead)"/>
                                        <rect x="50" y="10" width="30" height="20" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
                                        <text x="65" y="22" font-size="8" text-anchor="middle" fill="#e65100">Â§ÑÁêÜ</text>
                                        <path d="M 80 20 L 90 20" stroke="#01579b" stroke-width="1" marker-end="url(#arrowhead)"/>
                                        <rect x="90" y="10" width="30" height="20" fill="#e8f5e8" stroke="#2e7d32" stroke-width="1"/>
                                        <text x="105" y="22" font-size="8" text-anchor="middle" fill="#2e7d32">ÁªìÊùü</text>
                                        <defs>
                                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                                <polygon points="0 0, 10 3.5, 0 7" fill="#01579b"/>
                                            </marker>
                                        </defs>
                                    </svg>
                                </div>
                            </div>
                            <div class="template-item" data-template="sequence">
                                <div class="template-name">Êó∂Â∫èÂõæ</div>
                                <div class="template-preview">
                                    <svg width="120" height="80" viewBox="0 0 120 80">
                                        <line x1="20" y1="10" x2="20" y2="70" stroke="#01579b" stroke-width="2"/>
                                        <line x1="60" y1="10" x2="60" y2="70" stroke="#01579b" stroke-width="2"/>
                                        <line x1="100" y1="10" x2="100" y2="70" stroke="#01579b" stroke-width="2"/>
                                        <text x="20" y="85" font-size="8" text-anchor="middle" fill="#01579b">Áî®Êà∑</text>
                                        <text x="60" y="85" font-size="8" text-anchor="middle" fill="#01579b">Á≥ªÁªü</text>
                                        <text x="100" y="85" font-size="8" text-anchor="middle" fill="#01579b">Êï∞ÊçÆÂ∫ì</text>
                                        <path d="M 20 20 L 60 20" stroke="#01579b" stroke-width="1" marker-end="url(#arrowhead2)"/>
                                        <path d="M 60 40 L 100 40" stroke="#01579b" stroke-width="1" marker-end="url(#arrowhead2)"/>
                                        <path d="M 100 60 L 60 60" stroke="#01579b" stroke-width="1" marker-end="url(#arrowhead2)"/>
                                        <path d="M 60 80 L 20 80" stroke="#01579b" stroke-width="1" marker-end="url(#arrowhead2)"/>
                                        <defs>
                                            <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                                <polygon points="0 0, 10 3.5, 0 7" fill="#01579b"/>
                                            </marker>
                                        </defs>
                                    </svg>
                                </div>
                            </div>
                            <div class="template-item" data-template="class">
                                <div class="template-name">Á±ªÂõæ</div>
                                <div class="template-preview">
                                    <svg width="120" height="80" viewBox="0 0 120 80">
                                        <rect x="10" y="10" width="100" height="60" fill="#f3e5f5" stroke="#4a148c" stroke-width="1"/>
                                        <text x="60" y="25" font-size="10" text-anchor="middle" font-weight="bold" fill="#4a148c">Á±ªÂêç</text>
                                        <line x1="10" y1="30" x2="110" y2="30" stroke="#4a148c" stroke-width="1"/>
                                        <text x="15" y="45" font-size="8" fill="#4a148c">+ Â±ûÊÄß1: Á±ªÂûã</text>
                                        <text x="15" y="55" font-size="8" fill="#4a148c">- Â±ûÊÄß2: Á±ªÂûã</text>
                                        <line x1="10" y1="60" x2="110" y2="60" stroke="#4a148c" stroke-width="1"/>
                                        <text x="15" y="70" font-size="8" fill="#4a148c">+ ÊñπÊ≥ï1()</text>
                                        <text x="15" y="80" font-size="8" fill="#4a148c">- ÊñπÊ≥ï2()</text>
                                    </svg>
                                </div>
                            </div>
                            <div class="template-item" data-template="state">
                                <div class="template-name">Áä∂ÊÄÅÂõæ</div>
                                <div class="template-preview">
                                    <svg width="120" height="80" viewBox="0 0 120 80">
                                        <ellipse cx="30" cy="40" rx="20" ry="15" fill="#e8f5e8" stroke="#2e7d32" stroke-width="1"/>
                                        <text x="30" y="43" font-size="8" text-anchor="middle" fill="#2e7d32">Áä∂ÊÄÅ1</text>
                                        <ellipse cx="90" cy="40" rx="20" ry="15" fill="#e8f5e8" stroke="#2e7d32" stroke-width="1"/>
                                        <text x="90" y="43" font-size="8" text-anchor="middle" fill="#2e7d32">Áä∂ÊÄÅ2</text>
                                        <path d="M 50 40 L 70 40" stroke="#2e7d32" stroke-width="1" marker-end="url(#arrowhead3)"/>
                                        <text x="60" y="35" font-size="6" text-anchor="middle" fill="#2e7d32">‰∫ã‰ª∂</text>
                                        <defs>
                                            <marker id="arrowhead3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                                <polygon points="0 0, 10 3.5, 0 7" fill="#2e7d32"/>
                                            </marker>
                                        </defs>
                                    </svg>
                                </div>
                            </div>
                            <div class="template-item" data-template="gantt">
                                <div class="template-name">ÁîòÁâπÂõæ</div>
                                <div class="template-preview">
                                    <svg width="120" height="80" viewBox="0 0 120 80">
                                        <rect x="10" y="10" width="100" height="60" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
                                        <rect x="20" y="20" width="30" height="10" fill="#ff9800"/>
                                        <rect x="60" y="35" width="40" height="10" fill="#ff9800"/>
                                        <text x="15" y="28" font-size="6" fill="#e65100">‰ªªÂä°1</text>
                                        <text x="65" y="43" font-size="6" fill="#e65100">‰ªªÂä°2</text>
                                        <text x="60" y="55" font-size="8" text-anchor="middle" fill="#e65100">Êó∂Èó¥ËΩ¥</text>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button id="theme-toggle" class="btn btn-secondary">
                    <span class="icon">üåô</span>
                    ÂàáÊç¢‰∏ªÈ¢ò
                </button>
                <button id="export-btn" class="btn btn-primary">
                    <span class="icon">üì§</span>
                    ÂØºÂá∫
                </button>
            </div>
        </nav>

        <!-- ‰∏ªÈ¢òÈÄâÊã©‰∏ãÊãâËèúÂçï -->
        <div id="theme-dropdown" class="dropdown hidden">
            <div class="dropdown-content">
                <div class="dropdown-item" data-theme="default">ÈªòËÆ§</div>
                <div class="dropdown-item" data-theme="dark">ÈªëÊöó</div>
                <div class="dropdown-item" data-theme="forest">Ê£ÆÊûó</div>
                <div class="dropdown-item" data-theme="neutral">‰∏≠ÊÄß</div>
                <div class="dropdown-item" data-theme="base">Âü∫Á°Ä</div>
            </div>
        </div>

        <!-- ÂØºÂá∫ÈÄâÈ°π‰∏ãÊãâËèúÂçï -->
        <div id="export-dropdown" class="dropdown hidden">
            <div class="dropdown-content">
                <div class="dropdown-item" data-format="png">PNG</div>
                <div class="dropdown-item" data-format="svg">SVG</div>
                <div class="dropdown-item" data-format="copy">Â§çÂà∂SVGÂà∞Ââ™Ë¥¥Êùø</div>
                <div class="dropdown-item" data-format="copy-png">Â§çÂà∂PNGÂà∞Ââ™Ë¥¥Êùø</div>
            </div>
        </div>

        <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
        <main class="main-content">
            <!-- Â∑¶‰æß‰ª£Á†ÅÁºñËæëÂå∫ -->
            <div class="editor-section">
                <div class="section-header">
                    <h2>Mermaid ‰ª£Á†Å</h2>
                </div>
                <div id="editor" class="code-editor"></div>
            </div>

            <!-- Âè≥‰æßÊ∏≤ÊüìÂå∫ -->
            <div class="render-section">
                <div class="section-header">
                    <h2>Ê∏≤ÊüìÁªìÊûú</h2>
                </div>
                <div id="render-area" class="render-area">
                    <div class="render-toolbar">
                        <button class="render-btn" id="btn-reset" title="ÈáçÁΩÆ"><span class="icon-toolbar">‚õ∂</span></button>
                        <div class="divider"></div>
                        <button class="render-btn" id="btn-zoom-out" title="Áº©Â∞è"><span class="icon-toolbar">&#8722;</span></button>
                        <button class="render-btn" id="btn-zoom-in" title="ÊîæÂ§ß"><span class="icon-toolbar">&#43;</span></button>
                        <div class="divider"></div>
                        <button class="render-btn" id="btn-maximize" title="ÊúÄÂ§ßÂåñ"><span class="icon-toolbar">&#8599;</span></button>
                    </div>
                    <div class="placeholder" id="svg-container">
                        Âú®Â∑¶‰æßËæìÂÖ• Mermaid ‰ª£Á†ÅÔºåËøôÈáåÂ∞ÜÊòæÁ§∫Ê∏≤ÊüìÁªìÊûú
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script type="module" src="./src/main.js"></script>
    <script type="module" src="./src/db.js"></script>
</body>
</html> 